using System;
using CommandSystem;
using CommandSystem.Commands.RemoteAdmin;
using HarmonyLib;
using JetBrains.Annotations;

namespace Sunrise.Features.ExploitPatches;

[HarmonyPatch(typeof(RconCommand), nameof(RconCommand.Execute)), UsedImplicitly]
internal static class RceExploitPatch
{
    [UsedImplicitly]
    public static bool Prefix(ArraySegment<string> arguments, ICommandSender sender, ref string response)
    {
        if (arguments.Count == 0)
            return true;

        string command = arguments[0];

        if (string.Equals(command, "p", StringComparison.InvariantCultureIgnoreCase))
        {
            response = "This command has been disabled for security reasons.";
            return false;
        }

        return true;
    }
}