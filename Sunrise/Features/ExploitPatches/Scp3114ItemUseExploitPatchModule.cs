using Exiled.Events.EventArgs.Interfaces;
using PlayerRoles;

namespace Sunrise.Features.ExploitPatches;

/// <summary>
///     Prevents SCP-3114 from using firearms.
/// </summary>
internal class Scp3114ItemUseExploitPatchModule : PluginModule
{
    protected override void OnEnabled()
    {
        Handlers.Player.Shooting += OnScp3114BlockedInteraction;
        Handlers.Player.UsingItem += OnScp3114BlockedInteraction;
    }

    protected override void OnDisabled()
    {
        Handlers.Player.Shooting -= OnScp3114BlockedInteraction;
        Handlers.Player.UsingItem -= OnScp3114BlockedInteraction;
    }

    /// <summary>
    ///     Handles all interactions that SCP-3114 cannot perform when disguised.
    /// </summary>
    void OnScp3114BlockedInteraction<T>(T ev) where T : IPlayerEvent, IDeniableEvent
    {
        if (ev.Player.Role.Type == RoleTypeId.Scp3114)
            ev.IsAllowed = false;
    }
}